# keepalived configuration for ACTIVE frontend node
# Location: /etc/keepalived/keepalived.conf
# Node: 192.168.86.20 (or active node)
# VIP: 192.168.86.18

vrrp_script chk_okome {
  script "/usr/bin/curl -fs http://127.0.0.1/health || exit 1"
  interval 2
  timeout 1
  fall 2
  rise 2
}

vrrp_instance OKOME_CACHE {
  state MASTER
  interface eth0
  virtual_router_id 51
  priority 150
  advert_int 1

  authentication {
    auth_type PASS
    auth_pass OKOME_STRONG_PASS
  }

  virtual_ipaddress {
    192.168.86.18/24
  }

  track_script {
    chk_okome
  }
}

# Notes:
# - state MASTER: This node is the active node
# - priority 150: Higher priority = active
# - virtual_router_id 51: Must match on both nodes
# - auth_pass: Change to strong password
# - chk_okome: Health check script (checks local Nginx)
