# keepalived configuration for BACKUP frontend node
# Location: /etc/keepalived/keepalived.conf
# Node: Cold spare (becomes active if master fails)
# VIP: 192.168.86.18

vrrp_script chk_okome {
  script "/usr/bin/curl -fs http://127.0.0.1/health || exit 1"
  interval 2
  timeout 1
  fall 2
  rise 2
}

vrrp_instance OKOME_CACHE {
  state BACKUP
  interface eth0
  virtual_router_id 51
  priority 100
  advert_int 1

  authentication {
    auth_type PASS
    auth_pass OKOME_STRONG_PASS
  }

  virtual_ipaddress {
    192.168.86.18/24
  }

  track_script {
    chk_okome
  }
}

# Notes:
# - state BACKUP: This node is the backup
# - priority 100: Lower priority = backup
# - virtual_router_id 51: Must match master
# - auth_pass: Must match master
# - chk_okome: Health check script
